<md-content ng-if="!currentUser.profile.cart" layout="column" layout-align="center center">
  <h2>No items in your cart yet</h2>
  <h3>Maybe do some shopping and then come back?</h3>
</md-content>
<md-content ng-if="currentUser.profile.cart" layout="row" layout-align="center center">
  <span flex></span>
  <div flex="90" flex-md=100 flex-sm=100>
    <h1 class="text-center"> Shopping Cart </h1>

    <table class="material-table cart-table">
      <thead>
        <tr>
          <td></td>
          <td>
            Product
          </td>
          <td>
            Producer
          </td>
          <td>
            Price
          </td>
          <td>
            Quantity
          </td>
          <td>
            Total
          </td>
          <td></td>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <td colspan="7">
            Cart Total: {{total | currency}}
          </td>
        </tr>
      </tfoot>
      <tbody>
        <tr ng-repeat="item in currentUser.profile.cart.products track by item._id">
          <td>
            <a ui-sref="productDetails({productId: item.productId})">
              <cl-image public-id="{{item.details.img.result}}" class="thumbnail" >
                <cl-transformation height="80" width="80" crop="fill" gravity="center"></cl-transformation>
              </cl-image>
            </a>
          </td>
          <td>
            {{item.details.name}}
          </td>
          <td>
            {{item.details.producerCompanyName || item.details.producerName}}
          </td>
          <td>
            {{item.details.price * markup | currency}}
          </td>
          <td>
            <md-input-container class="input-table">
              <input type="number" name="qty" ng-model="item.qty" ng-model-options="{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }" ng-change="changeQuantity(item._id, item.productId, item.qty,  '{{item.qty}}')" min="1">
            </md-input-container>
          </td>
          <td>
            {{item.details.price * item.qty * markup | currency}}
          </td>
          <td>
            <md-button class="md-icon-button" aria-label="More" ng-click="removeFromCart(item._id)">
              <md-icon md-svg-icon="action:ic_delete_24px"></md-icon>
            </md-button>
          </td>
        </tr>
      </tbody>
    </table>

    <ui-view>
      <div layout="row" layout-align="center center">
        <md-button class="md-raised md-warn" ui-sref="profile.cart.checkout">Checkout</md-button>
        <md-button class="md-raised md-primary" ui-sref="store">Keep Shopping</md-button>
      </div>
    </ui-view>

  </div>
  <span flex></span>
</md-content>
