angular.module('food-coop').controller 'ProductsAdminCtrl', ($scope, $mdToast, $reactive) ->
  $reactive(this).attach($scope)
  @subscribe 'all-products'
  
  @sort = name: 1
  
  @priceWithMarkup =  (product) => Markup(product).total();
  
  @helpers
    products: () => return Products.find 
      $or: [
       { name:
           $regex: "^.*#{@getReactively('search')}"
           $options: 'i' }
       { 'producerName': 
           $regex: "^.*#{@getReactively('search')}"
           $options: 'i' }
       { 'producerCompanyName': 
           $regex: "^.*#{@getReactively('search')}"
           $options: 'i' }
      ]
    , {sort: @getReactively('sort') }
    
  @save = (product, modifier) ->
    Products.update product._id, modifier
          

  return

# ---
# generated by js2coffee 2.1.0
