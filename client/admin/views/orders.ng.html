<section layout="row" layout-align="center center" layout-wrap>
  <md-button class="md-raised md-primary" ng-click="lastweek()">Last Week</md-button> {{deliveryDay | date:'EEE dd/MM/yyyy'}}
  <md-button class="md-raised md-primary" ng-click="nextweek()">Next Week</md-button>
</section>
<!-- <section layout="row" layout-align="center center" layout-wrap>
  <md-checkbox ng-model="isActive" ng-true-value="'active'" ng-false-value="'all'" aria-label="show active">Show Current Week's Subscriptions Only</md-checkbox>
</section>
<section layout="row" layout-align="center center" layout-wrap>
  <md-button class="md-success" ng-repeat="hub in hubs" ng-click="$parent.hubFilter = hub.location">{{hub.title || hub.location}}</md-button>
</section> -->

<section layout="row" layout-align="center center" layout-wrap ng-show="isActive == 'active'">
  <figure ng-repeat="(product, count) in occurences(filteredOrders)" class="text-center">
    <h1 class="md-display-1">{{count}}</h1>
    <figcaption>
      <h3>{{product}}</h3>
    </figcaption>
  </figure>
</section>

<!-- <md-input-container class="md-icon-float">
  <md-icon md-svg-icon="action:ic_search_24px"></md-icon>
  <input ng-model="query" type="search">
</md-input-container> -->

<table class="material-table">
  <thead>
    <tr>
      <td>
        <md-button md-no-ink ng-click="reverse = !reverse">Sorted</md-button>
      </td>
      <td>
        <md-button md-no-ink ng-click="predicate='customer'; reverse = !reverse">Customer</md-button>
      </td>
      <td>
        <md-button md-no-ink ng-click="predicate='productName'; reverse = !reverse">Product</md-button>
      </td>
      <td>
        <md-button md-no-ink ng-click="predicate='producer'; reverse = !reverse">Producer</md-button>
      </td>
      <td>
        <md-button md-no-ink ng-click="predicate='price'; reverse = !reverse">Price</md-button>
      </td>
      <td><md-button md-no-ink>Tools</md-button></td>
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="order in orders | filter:searchstring | orderBy:predicate:reverse as filteredOrders track by order._id">
      <td>
        <md-button ng-click="order.sorted = !order.sorted">Sorted</md-button>
      </td>
      <td>
        <md-button ui-sref="admin.user({userId: order.user})"
        class="md-primary">
          {{user(order.customer).profile.name}}
        </md-button>
      </td>
      <td>
        x{{order.qty}} {{order.productName}}
      </td>
      <td>
        {{user(order.producerId).profile.companyName || user(order.producerId).profile.name}}
      </td>
      <td>
        {{order.qty}} @{{order.price | currency}} / {{order.unitOfMeasure}} <span ng-if="order.qty > 1">= {{order.qty*order.price | currency}}</span>
      </td>
      <td>
        <md-menu>
          <md-button md-menu-origin ng-mouseenter="$mdOpenMenu($event)"
           class="md-primary">tools</md-button>
          <md-menu-content>
            <md-menu-item>
              <md-button ui-sref="admin.order({orderId: order._id})">
                <div layout="row">
                  <md-icon md-svg-icon="action:ic_credit_card_24px"></md-icon>
                  <p flex>View Payment Details</p>
                </div>
              </md-button>
            </md-menu-item>
          </md-menu-content>
        </md-menu>
      </td>
    </tr>
  </tbody>
</table>
